# 梅花心易占卜应用 - 用户操作流程图

## 1. 整体用户旅程流程

```mermaid
flowchart TD
    A[用户发现应用] --> B[下载/访问应用]
    B --> C[首次启动]
    C --> D[用户注册/登录]
    D --> E[完善个人资料]
    E --> F[获得免费次数]
    F --> G[查看首页]
    G --> H[开始占卜]
    H --> I[输入问题]
    I --> J[占卜计算]
    J --> K[查看结果]
    K --> L{选择下一步}
    L -->|继续占卜| H
    L -->|分享结果| M[分享功能]
    L -->|查看历史| N[历史记录]
    L -->|返回首页| G
    M --> G
    N --> G
```

## 2. 用户注册登录流程

```mermaid
flowchart TD
    A[启动应用] --> B{是否已登录}
    B -->|是| C[进入首页]
    B -->|否| D[显示登录页面]
    D --> E{选择登录方式}
    E -->|已有账号| F[输入账号密码]
    E -->|新用户注册| G[选择注册方式]
    
    F --> H[验证登录信息]
    H --> I{验证结果}
    I -->|成功| C
    I -->|失败| J[显示错误信息]
    J --> F
    
    G --> K{注册方式}
    K -->|手机号| L[输入手机号]
    K -->|邮箱| M[输入邮箱]
    
    L --> N[发送短信验证码]
    M --> O[发送邮箱验证码]
    N --> P[输入验证码]
    O --> P
    P --> Q[设置密码]
    Q --> R[注册成功]
    R --> S[完善个人资料]
    S --> T[获得免费次数]
    T --> C
```

## 3. 占卜核心流程

```mermaid
flowchart TD
    A[首页] --> B[点击开始占卜]
    B --> C{检查剩余次数}
    C -->|有次数| D[进入问题输入页]
    C -->|无次数| E[显示购买/分享弹窗]
    E --> F{用户选择}
    F -->|分享获得| G[分享操作]
    F -->|购买次数| H[支付流程]
    F -->|取消| A
    G --> I[获得免费次数]
    H --> I
    I --> D
    
    D --> J[输入问题内容]
    J --> K{问题验证}
    K -->|通过| L[选择问题类型]
    K -->|不通过| M[显示提示信息]
    M --> J
    
    L --> N[确认开始占卜]
    N --> O[扣减次数]
    O --> P[显示占卜进行中]
    P --> Q[梅花易数算法计算]
    Q --> R[AI解读生成]
    R --> S[显示占卜结果]
    S --> T{用户操作选择}
    T -->|继续占卜| B
    T -->|分享结果| U[分享功能]
    T -->|查看历史| V[历史记录]
    T -->|返回首页| A
```

## 4. 免费次数管理流程

```mermaid
flowchart TD
    A[用户操作] --> B{检查次数}
    B -->|有免费次数| C[正常使用功能]
    B -->|次数不足| D[显示次数不足弹窗]
    D --> E{用户选择}
    E -->|分享获得| F[显示分享选项]
    E -->|邀请好友| G[生成邀请链接]
    E -->|购买次数| H[进入支付页面]
    E -->|稍后再说| I[返回上一页]
    
    F --> J[选择分享平台]
    J --> K[执行分享操作]
    K --> L{分享成功}
    L -->|成功| M[增加免费次数]
    L -->|失败| N[显示失败提示]
    
    G --> O[发送邀请]
    O --> P{好友注册}
    P -->|成功| Q[双方获得奖励]
    P -->|失败| R[等待好友注册]
    
    M --> C
    Q --> C
```

## 5. 历史记录查看流程

```mermaid
flowchart TD
    A[点击历史记录] --> B[加载历史数据]
    B --> C[显示记录列表]
    C --> D{用户操作}
    D -->|筛选记录| E[选择筛选条件]
    D -->|搜索记录| F[输入搜索关键词]
    D -->|查看详情| G[点击具体记录]
    D -->|返回首页| H[返回首页]
    
    E --> I[应用筛选条件]
    I --> J[显示筛选结果]
    J --> C
    
    F --> K[执行搜索]
    K --> L[显示搜索结果]
    L --> C
    
    G --> M[显示详细结果]
    M --> N{详情页操作}
    N -->|重新占卜| O[跳转问题输入]
    N -->|分享结果| P[分享功能]
    N -->|返回列表| C
```

## 6. 用户中心管理流程

```mermaid
flowchart TD
    A[进入用户中心] --> B[显示用户信息]
    B --> C{用户操作选择}
    C -->|个人资料| D[编辑个人信息]
    C -->|次数管理| E[查看次数详情]
    C -->|会员中心| F[会员服务页面]
    C -->|设置功能| G[应用设置]
    C -->|帮助支持| H[帮助页面]
    C -->|退出登录| I[确认退出]
    
    D --> J[保存修改]
    J --> K{保存结果}
    K -->|成功| L[显示成功提示]
    K -->|失败| M[显示错误信息]
    L --> B
    M --> D
    
    E --> N[显示次数统计]
    N --> O{次数操作}
    O -->|购买次数| P[支付流程]
    O -->|分享获得| Q[分享操作]
    O -->|返回| B
    
    I --> R{确认退出}
    R -->|确认| S[清除登录状态]
    R -->|取消| B
    S --> T[返回登录页]
```

## 7. 错误处理流程

```mermaid
flowchart TD
    A[用户操作] --> B{操作执行}
    B -->|成功| C[正常流程继续]
    B -->|网络错误| D[显示网络错误提示]
    B -->|服务器错误| E[显示服务器错误提示]
    B -->|参数错误| F[显示参数错误提示]
    B -->|权限错误| G[显示权限错误提示]
    
    D --> H{用户选择}
    E --> H
    F --> H
    G --> H
    
    H -->|重试| I[重新执行操作]
    H -->|取消| J[返回上一步]
    H -->|联系客服| K[打开客服页面]
    
    I --> B
    J --> L[恢复到操作前状态]
    K --> M[显示联系方式]
```

## 8. 数据同步流程

```mermaid
flowchart TD
    A[应用启动] --> B[检查网络状态]
    B --> C{网络可用}
    C -->|是| D[同步用户数据]
    C -->|否| E[使用本地缓存]
    
    D --> F[获取最新数据]
    F --> G{同步结果}
    G -->|成功| H[更新本地数据]
    G -->|失败| I[使用本地数据]
    
    H --> J[显示最新内容]
    I --> K[显示离线提示]
    E --> K
    
    K --> L[定期检查网络]
    L --> M{网络恢复}
    M -->|是| D
    M -->|否| L
```

---

**流程图说明**:
- 使用Mermaid语法绘制，支持在支持Mermaid的Markdown编辑器中直接渲染
- 涵盖了应用的主要用户操作流程
- 包含了异常情况的处理流程
- 可根据实际开发需求进行调整和细化

**文档版本**: v1.0  
**最后更新**: 2025-01-26  
**维护者**: 产品设计团队
